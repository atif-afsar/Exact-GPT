@import './variables.css';

/* Chat app layout */
.chat-app {
  min-height: 100vh;
  display: flex;
  gap: 0.5rem;
  background: var(--bg);
  padding: 1rem;
  box-sizing: border-box;
}

/* Sidebar (desktop) */
.sidebar {
  width: 100%;
  max-width: 260px;
  background: rgba(255,255,255,0.02);
  border-radius: var(--radius);
  padding: 0.5rem;
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  position: relative;
  border: 1px solid rgba(255,255,255,0.03);
}

.sidebar-top {
  display:flex;align-items:center;justify-content:space-between;gap:8px;padding:0 6px
}

.brand { display:flex; gap:8px; align-items:center }
.brand-dot { width:34px; height:34px; border-radius:10px; background: linear-gradient(135deg,#2b2b2b,#121212); display:inline-block; box-shadow: var(--shadow); }
.brand strong { font-size:0.95rem; color: var(--text) }
.btn.small.new-chat { background: rgba(255,255,255,0.06); border-radius: 8px }

.btn.small { padding: .45rem .6rem; font-size:.85rem; border-radius:8px; color: var(--text); }

.chats-list { list-style:none; padding:0; margin:0; overflow:auto }
.chat-item {
  padding: 0.6rem;
  border-radius: 10px;
  cursor: pointer;
  margin-bottom: 0.5rem;
  background: transparent;
  color: var(--text);
}

.chat-item.active { background: rgba(255,255,255,0.03); border-left: 3px solid rgba(255,255,255,0.06) }
.chat-title { font-weight:600; font-size:.95rem; color: var(--text) }
.chat-preview { font-size:.78rem; color:var(--muted); margin-top:4px }

/* Main chat panel */
.chat-panel {
  flex: 1;
  display: flex;
  flex-direction: column;
  height: calc(100vh - 2rem);
  color: var(--text);
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  border-radius: calc(var(--radius) + 4px);
  border: 1px solid rgba(255,255,255,0.02);
  overflow: hidden;
  min-width: 0; /* prevent overflow on small screens */
}

.chat-header {
  padding: 0.9rem 1rem;
  border-bottom: 1px solid rgba(255,255,255,0.04);
  display:flex;align-items:center;gap:.75rem;justify-content:space-between;
}
.chat-header-main { display:flex; align-items:center; gap:12px }
.chat-header-title { font-weight:700; color: var(--text); font-size:1.05rem }
.avatar { width:36px; height:36px; border-radius:12px; display:grid;place-items:center;background:rgba(255,255,255,0.04); color:var(--text); font-weight:700 }
.chat-header-actions .icon-btn { background: transparent; border: 1px solid rgba(255,255,255,0.03); padding:6px 8px; border-radius:8px }

.messages {
  padding: 1rem;
  overflow:auto;
  flex: 1;
  display:flex;
  flex-direction:column;
  gap: .75rem;
}

/* Welcome card when there are no messages */
.messages.welcome { align-items: center; justify-content: center }
.welcome-card { background: rgba(255,255,255,0.02); padding: 2rem; border-radius: 14px; text-align:center; max-width:720px; color:var(--text); border:1px solid rgba(255,255,255,0.03) }
.welcome-card h2 { margin:0 0 .5rem 0; font-size:1.25rem }
.welcome-card .muted { color: var(--muted); margin-bottom: .75rem }
.welcome-examples { display:flex; gap:.6rem; justify-content:center; margin-top:.75rem }
.chip { padding:.45rem .7rem; border-radius:999px; background: rgba(255,255,255,0.03); color:var(--text); font-size:0.9rem }

.bubble-text { white-space: pre-wrap; word-break: break-word }
.bubble-footer { display:flex; justify-content:space-between; gap:8px; margin-top:6px; align-items:center; font-size:.78rem; color:var(--muted) }
.bubble-footer .ts { color: var(--muted); font-size:0.78rem }
.actions .icon { background: transparent; border: 1px solid transparent; padding:4px; border-radius:6px; color:var(--muted); }
.actions .icon:hover { background: rgba(255,255,255,0.03); color:var(--text) }

/* ensure strong contrast for interactive elements */
.btn, .icon-btn, .chip { color: var(--text) }
.icon-btn:hover { background: rgba(255,255,255,0.03) }

/* small icon size classes */
.icon.small { font-size: 0.95rem; line-height:1 }


.message-row { display:flex }
.message-user { justify-content: flex-end }
.message-ai { justify-content: flex-start }

.bubble {
  max-width: 78%;
  padding: .85rem .95rem;
  border-radius: 14px;
  background: rgba(255,255,255,0.02);
  color: var(--text);
  border: 1px solid rgba(255,255,255,0.03);
  box-shadow: 0 2px 10px rgba(2,6,12,0.5);
}

.message-user .bubble {
  background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
  color: var(--text);
}

/* make sure AI/welcome text is legible on dark backgrounds */
.message-ai .bubble { color: var(--text); opacity: 0.96 }

.composer {
  padding: .55rem;
  border-top: 1px solid rgba(255,255,255,0.04);
  display:flex;gap:.5rem;align-items:center;
  background: linear-gradient(180deg, rgba(255,255,255,0.00), rgba(255,255,255,0.01));
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.01);
}

.composer .composer-inner { display:flex; gap:.6rem; width:100%; align-items:center }
.composer .input {
  flex: 1;
  min-height: 44px;
  max-height: 160px;
  resize: vertical;
  padding: .7rem .9rem;
  border-radius: 10px;
  border: 1px solid var(--input-border);
  background: var(--input-bg);
  color: var(--text);
  box-shadow: none;
  font-size: 0.95rem;
  line-height: 1.3;
}
.composer .input::placeholder { color: rgba(255,255,255,0.45) }

.btn.send {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: .45rem .75rem;
  border-radius: 10px;
  background: transparent;
  color: var(--text);
  border: 1px solid rgba(255,255,255,0.04);
  box-shadow: none;
  cursor: pointer;
  transition: background 120ms ease, transform 100ms ease, opacity 120ms ease;
}
.btn.send .icon { display:inline-flex }
.btn.send .label { font-weight:600 }
.btn.send:hover { background: rgba(255,255,255,0.03); transform: translateY(-1px) }
.btn.send.disabled, .btn.send:disabled { opacity: 0.45; cursor: not-allowed; transform: none }

/* Mobile: off-canvas sidebar + backdrop */
.sidebar {
  position: fixed;
  inset: 0 auto 0 0;
  left: 0;
  top: 0;
  bottom: 0;
  width: 72vw;
  max-width: 300px;
  transform: translateX(-110%);
  transition: transform 220ms ease;
  z-index: 60;
}
.sidebar.open { transform: translateX(0); box-shadow: 0 8px 30px rgba(2,6,23,0.6); }

.backdrop {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  z-index: 50;
}

/* Mobile toggle button */
.mobile-toggle {
  display: inline-grid;
  place-items: center;
  width: 35px;
  height: 30px;
  border-radius: 5px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.03);
}

/* Make composer sticky so keyboard won't hide it on mobile */
.composer { position: sticky; bottom: 0; background: transparent; }

/* Mobile typography and spacing fixes */
html, body { -webkit-text-size-adjust: 100%; }
.chat-title { font-size: 1rem }
.chat-preview { font-size: .78rem }
.bubble { font-size: 0.95rem }


/* Mobile-first sizes */
@media (min-width: 640px) {
  .sidebar { position: relative; transform: none; max-width: 260px; width: 100% }
  .chat-item { display:block }
  .bubble { max-width: 66% }
  /* hide mobile toggle on wider screens */
  .mobile-toggle { display: none }
}

/* Mobile adjustments */
@media (max-width: 639px) {
  .chat-app { padding: 0.5rem }
  .sidebar { width: 78vw; max-width: 280px }
  .chat-panel { border-radius: 8px; height: 100vh }
  .messages { padding: 0.75rem }
  .composer .input { min-height: 40px }
  .brand-dot { width:28px; height:28px }
  .chat-header-title { font-size: 0.95rem }
}

@media (min-width: 980px) {
  .sidebar { max-width: 260px }
  .chat-app { gap: 1rem }
}
